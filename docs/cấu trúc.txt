# Cáº¤U TRÃšC Há»† THá»NG QR ORDER PLATFORM

## ğŸ“ Cáº¥u trÃºc thÆ° má»¥c tá»•ng thá»ƒ

```
root/
â”œâ”€â”€ backend/                    # Backend API Server (Node.js/Express)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app.js             # Express app entry point
â”‚   â”‚   â”œâ”€â”€ config/            # Configuration files
â”‚   â”‚   â”‚   â”œâ”€â”€ database.js    # MySQL connection
â”‚   â”‚   â”‚   â”œâ”€â”€ redis.js       # Redis client
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.js         # JWT configuration
â”‚   â”‚   â”‚   â”œâ”€â”€ logger.js      # Winston logger
â”‚   â”‚   â”‚   â””â”€â”€ index.js       # Config exports
â”‚   â”‚   â”œâ”€â”€ controllers/       # Route controllers (Business Logic)
â”‚   â”‚   â”‚   â”œâ”€â”€ authController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ branchController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ menuController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ orderController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ tableController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ customerController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ analyticsController.js
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ services/          # Business logic services
â”‚   â”‚   â”‚   â”œâ”€â”€ authService.js
â”‚   â”‚   â”‚   â”œâ”€â”€ menuService.js
â”‚   â”‚   â”‚   â”œâ”€â”€ orderService.js
â”‚   â”‚   â”‚   â”œâ”€â”€ customerService.js
â”‚   â”‚   â”‚   â”œâ”€â”€ paymentService.js
â”‚   â”‚   â”‚   â”œâ”€â”€ analyticsService.js
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ models/           # Database models (Data Access)
â”‚   â”‚   â”‚   â”œâ”€â”€ User.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Branch.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Table.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Category.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Product.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Order.js
â”‚   â”‚   â”‚   â”œâ”€â”€ OrderItem.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Customer.js
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ routes/           # API routes
â”‚   â”‚   â”‚   â”œâ”€â”€ index.js      # Main router
â”‚   â”‚   â”‚   â”œâ”€â”€ authRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ brancheRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ menuRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ orderRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ tableRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ customerRoutes.js
â”‚   â”‚   â”‚   â””â”€â”€ analyticsRoutes.js
â”‚   â”‚   â”œâ”€â”€ middlewares/     # Express middlewares
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js       # JWT authentication
â”‚   â”‚   â”‚   â”œâ”€â”€ errorHandler.js
â”‚   â”‚   â”‚   â”œâ”€â”€ rateLimiter.js
â”‚   â”‚   â”‚   â”œâ”€â”€ validator.js
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ validators/       # Request validation
â”‚   â”‚   â”‚   â”œâ”€â”€ authValidator.js
â”‚   â”‚   â”‚   â”œâ”€â”€ orderValidator.js
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ utils/           # Utility functions
â”‚   â”‚   â”‚   â”œâ”€â”€ errors.js    # Custom error classes
â”‚   â”‚   â”‚   â”œâ”€â”€ response.js  # Response helpers
â”‚   â”‚   â”‚   â”œâ”€â”€ helpers.js
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ sockets/         # Socket.io handlers
â”‚   â”‚   â”‚   â”œâ”€â”€ index.js
â”‚   â”‚   â”‚   â””â”€â”€ handlers/
â”‚   â”‚   â”‚       â”œâ”€â”€ orderHandlers.js
â”‚   â”‚   â”‚       â”œâ”€â”€ tableHandlers.js
â”‚   â”‚   â”‚       â”œâ”€â”€ kitchenHandlers.js
â”‚   â”‚   â”‚       â””â”€â”€ notificationHandlers.js
â”‚   â”‚   â””â”€â”€ jobs/            # Background jobs
â”‚   â”‚       â””â”€â”€ index.js
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ .env.example
â”‚
â”œâ”€â”€ frontend-customer/        # Customer Web App (Next.js 14)
â”‚   â”œâ”€â”€ app/                  # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ layout.tsx        # Root layout
â”‚   â”‚   â”œâ”€â”€ page.tsx          # Home page
â”‚   â”‚   â”œâ”€â”€ globals.css       # Global styles
â”‚   â”‚   â”œâ”€â”€ customer/         # Customer routes
â”‚   â”‚   â”‚   â”œâ”€â”€ menu/         # Menu page
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ cart/         # Cart page
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ checkout/     # Checkout page
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ order-status/ # Order status
â”‚   â”‚   â”‚       â””â”€â”€ [id]/
â”‚   â”‚   â”‚           â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ order/            # Order routes
â”‚   â”‚       â””â”€â”€ [id]/
â”‚   â”‚           â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ components/          # React components
â”‚   â”‚   â”œâ”€â”€ menu/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CategoryTabs.tsx
â”‚   â”‚   â”‚   â””â”€â”€ CategoryFilter.tsx
â”‚   â”‚   â”œâ”€â”€ cart/
â”‚   â”‚   â”‚   â”œâ”€â”€ CartFloatingBar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CartSummary.tsx
â”‚   â”‚   â”‚   â””â”€â”€ CartItem.tsx
â”‚   â”‚   â”œâ”€â”€ order/
â”‚   â”‚   â”‚   â””â”€â”€ OrderStatus.tsx
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â””â”€â”€ Header.tsx
â”‚   â”‚   â””â”€â”€ shared/
â”‚   â”‚       â”œâ”€â”€ Button.tsx
â”‚   â”‚       â””â”€â”€ Loading.tsx
â”‚   â”œâ”€â”€ lib/                 # Utilities
â”‚   â”‚   â””â”€â”€ api.ts           # API client
â”‚   â”œâ”€â”€ store/               # State management
â”‚   â”‚   â””â”€â”€ cartStore.ts     # Zustand cart store
â”‚   â”œâ”€â”€ types/               # TypeScript types
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ hooks/               # Custom hooks
â”‚   â”‚   â””â”€â”€ useSocket.ts
â”‚   â”œâ”€â”€ public/             # Static assets
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â””â”€â”€ next.config.js
â”‚
â”œâ”€â”€ frontend-admin/          # Admin Portal (React SPA)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/           # Page components
â”‚   â”‚   â”œâ”€â”€ components/     # Reusable components
â”‚   â”‚   â”œâ”€â”€ services/        # API services
â”‚   â”‚   â”œâ”€â”€ store/          # State management
â”‚   â”‚   â””â”€â”€ utils/          # Utilities
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ docs/                    # Documentation
â”‚   â”œâ”€â”€ architecture/        # Architecture docs
â”‚   â”‚   â”œâ”€â”€ system-design.md
â”‚   â”‚   â”œâ”€â”€ database-schema.md
â”‚   â”‚   â”œâ”€â”€ api-design.md
â”‚   â”‚   â””â”€â”€ realtime-flow.md
â”‚   â”œâ”€â”€ development/         # Development guides
â”‚   â”‚   â”œâ”€â”€ setup-guide.md
â”‚   â”‚   â”œâ”€â”€ coding-standards.md
â”‚   â”‚   â””â”€â”€ sample-data/
â”‚   â”œâ”€â”€ deployment/          # Deployment guides
â”‚   â”‚   â”œâ”€â”€ docker-guide.md
â”‚   â”‚   â”œâ”€â”€ cloud-deployment.md
â”‚   â”‚   â””â”€â”€ scaling-strategy.md
â”‚   â””â”€â”€ user-guides/         # User manuals
â”‚       â”œâ”€â”€ admin-manual.md
â”‚       â”œâ”€â”€ customer-manual.md
â”‚       â””â”€â”€ kitchen-manual.md
â”‚
â”œâ”€â”€ database/               # Database scripts
â”‚   â”œâ”€â”€ init.sql           # Initial schema
â”‚   â”œâ”€â”€ migrations/        # Migration scripts
â”‚   â””â”€â”€ seeds/             # Seed data
â”‚
â”œâ”€â”€ docker-compose.yml     # Docker compose config
â””â”€â”€ README.md              # Project README
```

## ğŸ”§ Backend Structure (Layered Architecture)

### Presentation Layer (Routes)
- **authRoutes.js**: Authentication endpoints
- **brancheRoutes.js**: Branch management
- **menuRoutes.js**: Menu & products
- **orderRoutes.js**: Order management
- **tableRoutes.js**: Table management
- **customerRoutes.js**: Customer management
- **analyticsRoutes.js**: Analytics & reports

### Business Logic Layer (Controllers + Services)
- **Controllers**: Handle HTTP requests/responses
- **Services**: Business logic, data transformation

### Data Access Layer (Models)
- **Models**: Database queries, data validation

## ğŸ¨ Frontend Structure

### Customer App (Next.js 14)
- **App Router**: File-based routing
- **Components**: Reusable UI components
- **Store**: Zustand for state management
- **API Client**: Axios-based API calls
- **Types**: TypeScript definitions

## ğŸ“Š Database Schema

### Core Tables
1. **branches**: Chi nhÃ¡nh
2. **tables**: BÃ n Äƒn
3. **categories**: Danh má»¥c mÃ³n
4. **products**: Sáº£n pháº©m/MÃ³n Äƒn
5. **customers**: KhÃ¡ch hÃ ng
6. **orders**: ÄÆ¡n hÃ ng
7. **order_items**: Chi tiáº¿t Ä‘Æ¡n hÃ ng
8. **staff**: NhÃ¢n viÃªn
9. **segments**: PhÃ¢n khÃºc khÃ¡ch hÃ ng
10. **promotions**: Khuyáº¿n mÃ£i

### Supporting Tables
- **activity_logs**: Nháº­t kÃ½ hÃ nh vi
- **loyalty_points**: Äiá»ƒm tÃ­ch lÅ©y
- **ingredients**: NguyÃªn liá»‡u
- **recipes**: CÃ´ng thá»©c mÃ³n
- **notifications**: ThÃ´ng bÃ¡o
- **inventory_transactions**: Giao dá»‹ch kho
- **sales_reports**: BÃ¡o cÃ¡o doanh thu
- **ai_recommendations**: Gá»£i Ã½ AI
- **product_reviews**: ÄÃ¡nh giÃ¡ mÃ³n

## ğŸ”Œ API Endpoints

### Base URL
- Development: `http://localhost:5000/api/v1`
- Production: `https://api.qrorder.vn/api/v1`

### Main Endpoints
- `/auth/*` - Authentication
- `/menu/*` - Menu & products
- `/orders/*` - Order management
- `/tables/*` - Table management
- `/customers/*` - Customer management
- `/analytics/*` - Analytics & reports
- `/branches/*` - Branch management

## ğŸš€ Technology Stack

### Backend
- **Runtime**: Node.js 18+
- **Framework**: Express.js
- **Database**: MySQL 8.0
- **Cache**: Redis 7
- **Real-time**: Socket.io
- **Auth**: JWT

### Frontend Customer
- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **State**: Zustand
- **HTTP**: Axios

### Infrastructure
- **Container**: Docker
- **Reverse Proxy**: Nginx
- **Monitoring**: Winston (Logging)

## ğŸ“ File Naming Conventions

### Backend
- Controllers: `*Controller.js` (PascalCase)
- Services: `*Service.js` (PascalCase)
- Models: `*.js` (PascalCase)
- Routes: `*Routes.js` (camelCase)
- Middlewares: `*.js` (camelCase)

### Frontend
- Components: `*.tsx` (PascalCase)
- Pages: `page.tsx` (lowercase)
- Hooks: `use*.ts` (camelCase)
- Utils: `*.ts` (camelCase)
- Types: `*.ts` (camelCase)

## ğŸ” Security

- JWT Authentication
- Role-Based Access Control (RBAC)
- Rate Limiting
- Input Validation
- SQL Injection Prevention
- XSS Protection

## ğŸ“ˆ Performance

- Redis Caching
- Database Indexing
- Connection Pooling
- Image Optimization
- Code Splitting (Frontend)
- Lazy Loading

## ğŸ§ª Testing

- Unit Tests: Jest
- Integration Tests: Supertest
- E2E Tests: Playwright

## ğŸ“¦ Deployment

- Docker Compose (Development)
- Docker Swarm / Kubernetes (Production)
- CI/CD Pipeline
- Environment Variables Management

